# NAS統合管理ダッシュボード

NAS環境で稼働する統合管理ダッシュボードシステムです。

## 🚀 機能概要

### メイン機能
- **システム監視**: 各プロジェクトの稼働状況をリアルタイム監視
- **ログ監視**: システムログとDockerコンテナログの統合監視
- **AI分析**: Gemini AIによるセキュリティ分析とログ分析
- **バックアップ管理**: 自動バックアップの実行と管理
- **レポート管理**: 週次レポート・月次AI分析レポートの生成とメール送信

> **注意**: Fail2Ban監視機能は**NAS監視システム**（nas-dashboard-monitoring）に統合されました。セキュリティ監視は「NAS監視システム」ボタンからアクセスできます。

### ログ監視機能
- **テキストログ**: 各システムのログファイルを個別表示
  - Meeting Minutes BYC
  - Amazon Analytics
  - Document Automation
  - YouTube to Notion
  - NAS Dashboard
- **Dockerログ**: 全コンテナのログをリアルタイム表示
- **AIログ分析**: Gemini AIによる包括的なログ分析
- **フィルタリング**: ログレベル別フィルタリング機能
- **自動更新**: 定期的なログ更新機能

### AI分析機能
- **セキュリティ分析**: Fail2banデータのAI分析（レポート生成用）
- **ログ分析**: システムログとDockerログの統合分析
  - **テキストログ分析**: 各システムのログファイル分析
  - **Dockerログ分析**: コンテナログの生データ分析
  - **ハイブリッド分析**: テキストログとDockerログの統合分析
- **自動分析**: 全システムの一括分析機能
- **推奨事項**: AIによる問題診断と改善提案
- **生ログテキスト方式**: Dockerログを直接取得してAIに送信

## 🛠 技術スタック

- **Backend**: Python Flask
- **Frontend**: HTML5, Bootstrap 5, JavaScript
- **Database**: SQLite
- **Container**: Docker & Docker Compose
- **Monitoring**: 統合ログ監視システム

## 📁 プロジェクト構成

```
nas-dashboard/
├── app.py                 # メインアプリケーション
├── templates/
│   ├── dashboard.html     # メインダッシュボード
│   └── log_viewer.html   # ログ監視画面
├── config/
│   └── settings.py        # 設定ファイル
├── utils/
│   ├── ai_analyzer.py     # AI分析機能
│   └── email_sender.py    # メール送信機能
├── scripts/
│   ├── auto_version_update.py           # 自動バージョン更新
│   ├── weekly_report_scheduler.py       # 週次レポートスケジューラー
│   └── monthly_ai_report_scheduler.py   # 月次AI分析レポートスケジューラー
├── docker-compose.yml     # Docker Compose設定
├── Dockerfile            # Docker設定
└── requirements.txt      # Python依存関係
```

## 🚀 セットアップ

### 1. 環境変数設定
```bash
# .env ファイルを作成
cp env.example .env

# 必要な設定を編集
vim .env

# .env.restoreをバックアップとして作成（推奨）
cp .env .env.restore
```

⚠️ **重要**: 実行時には`.env`のみを使用します。`.env.restore`はバックアップファイルとして保存しておくだけです。

### 2. Docker起動
```bash
# 開発環境
docker compose up -d

# 本番環境（NAS）
docker compose -f docker-compose.yml up -d --build
```

### 3. アクセス
- **ダッシュボード**: http://YOUR_IP_ADDRESS110:9001
- **ログ監視**: http://localhost:9001/logs

## 📊 ログ監視機能詳細

### テキストログ監視
- 各システムのログファイルを個別に監視
- ドロップダウンでシステムを選択
- 最新50行のログを表示
- ログレベル別の色分け表示

### Dockerログ監視
- 全Dockerコンテナのログを監視
- ドロップダウンでコンテナを選択
- 最新100行のログを表示
- 空行フィルタリング機能

### フィルタリング機能
- **INFO**: 情報ログ（白色）
- **WARNING**: 警告ログ（黄色）
- **ERROR**: エラーログ（赤色）
- **DEBUG**: デバッグログ（灰色）

## 🔧 開発・メンテナンス

### バージョン管理
- 自動バージョン更新機能
- Gitコミット時に自動バージョンアップ
- セマンティックバージョニング対応

### ログ設定
- 各システムのログファイルパス設定
- ログレベル設定
- ローテーション設定

### デプロイメント
- NAS環境への自動デプロイ
- Docker Composeによるコンテナ管理
- 環境変数による設定管理

## 📝 更新履歴

### v1.5.2 (2025-10-31)
- **機能統合**: Fail2Ban監視機能をNAS監視システム（nas-dashboard-monitoring）に統合
- Fail2Ban関連のAPIエンドポイントとUIを削除（監視システムで一元管理）
- サービス一覧からFail2Ban専用ボタンを削除（NAS監視システムからアクセス）

### v1.5.1 (2025-10-27)
- **重要修正**: 週次レポートの2重送信問題を解決
- 週次レポートスケジューラーコンテナを無効化
- APIエンドポイント経由での手動実行に統一
- 月次レポートスケジューラーは正常稼働継続

### v1.5.0 (2025-10-26)
- AI分析機能の統合実装
- セキュリティ分析とログ分析のAI化
- Dockerログ分析の生ログテキスト方式実装
- ハイブリッドログ分析機能（テキストログ + Dockerログ）
- システムタイプ自動判定機能
- 月次AI分析レポート自動送信機能
- 週次レポート・月次レポートのスケジューラー実装
- レポート管理機能の改善
- 重複機能の削除と整理

### v1.1.0 (2025-10-25)
- ログ監視機能追加
- テキストログとDockerログの統合監視
- デザイン改善とUI統一
- 空行フィルタリング機能

### v1.0.0 (2025-01-21)
- 初期リリース
- 基本ダッシュボード機能
- システム監視機能

## 🤝 貢献

1. 機能追加やバグ修正
2. ドキュメントの改善
3. テストケースの追加

## 📄 ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 📞 サポート

問題や質問がある場合は、GitHubのIssuesページで報告してください。
